# WCMaaS like stack
#
# - Apache 2.2
# - MySQL 5.5
# - PHP 5.6 / PHP 7.0
# - Memcached 1.4

version: "2.1"

services:
  # Web
  web:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: web
    depends_on:
      - cli
    ports:
      - "${APACHE_PORT_MAPPING:-80}"

  # DB
  db:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: db

  # CLI
  cli:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: cli
    #image: ${COMPOSE_PROJECT_NAME_SAFE}_cli
    #build: ${PROJECT_ROOT}/.docksal/services/cli
    #command: /var/www/.docksal/etc/cli/start.sh
    environment:
      - XDEBUG_ENABLED=1

  # Memcached
  memcached1:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: memcached
    hostname: memcached1
  memcached2:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: memcached
    hostname: memcached2
  memcached3:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: memcached
    hostname: memcached3
  memcached4:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: memcached
    hostname: memcached4